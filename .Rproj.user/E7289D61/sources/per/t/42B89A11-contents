library(neuralnet)

winedata = read.csv('/Users/elias/Downloads/winedata2.csv')

#2 Architecture

cat0 = c()
cat1 = c()
  
for(l in 1:length(winedata$WineClass)){
  if(winedata$WineClass[l] == 1){
    cat0 = c(cat0, 1)
    cat1 = c(cat1, 0)
  }
  if(winedata$WineClass[l] == 2){
    cat0 = c(cat0, 0)
    cat1 = c(cat1, 1)
  }
}

#Selecting 2 different variables from the data
winedata = winedata[,-1]

#Using Variable Malic acid and Alcohol
winedata = cbind(cat0, cat1, Malic.acid = winedata$Malic.acid, Alcohol = winedata$Alcohol)

#Seperating data into Training and Test
datTraining = winedata [1:65,]
datTest = winedata [66:130,]


testValues = datTest[,-(1:2)]
testClasses = datTest[,1:2]

set.seed(47)

NN = neuralnet(datTraining[,1] + datTraining[,2] ~., datTraining[,3:4], hidden = c(5), threshold = 0.2, 
stepmax = 1e+05, linear.output = FALSE)

plot(NN)

#Error = how well the network performs.

#Prediction
NNPred = predict(NN, testValues)

CorrectNumber = 0
for(column in 1:(length(NNPred [,1]))){
  for(row in 1:(length(NNPred [1,]))){
    
    Correct = (round(NNPred[column,row])==testClasses[column,row])
    if(Correct){
      CorrectNumber = CorrectNumber + 1
    }
  }
}


#Calculating accuracy
n = length(NNPred)
accuracy = CorrectNumber/n





                                                